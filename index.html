<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PULSEAI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: linear-gradient(135deg, #1a1a2e, #16213e); color: white; font-family: 'Segoe UI', sans-serif; }
    .card { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
    input, button { transition: all 0.3s; }
    button:hover { transform: translateY(-2px); }
    .use-case { animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</head>
<body class="min-h-screen p-6">
  <div class="max-w-6xl mx-auto">
    <h1 class="text-5xl font-bold text-center mb-2 bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent">PULSEAI</h1>
    <p class="text-center text-gray-400 mb-10">AI-Powered Sales Use Cases in 10 Seconds</p>

    <div class="grid md:grid-cols-2 gap-6 mb-10">
      <div class="card p-6 rounded-2xl">
        <h2 class="text-xl font-semibold mb-4">Your Info</h2>
        <input id="job" placeholder="Job Title" class="w-full p-3 mb-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400">
        <input id="company" placeholder="Your Company" class="w-full p-3 mb-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400">
        <input id="product" placeholder="Your Product" class="w-full p-3 mb-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400">
        <input id="target" placeholder="Target Company (e.g. Xero)" class="w-full p-3 mb-4 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400">
        <button onclick="generate()" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-3 rounded-lg shadow-lg hover:shadow-xl">
          GO
        </button>
      </div>

      <div class="card p-6 rounded-2xl">
        <h2 class="text-xl font-semibold mb-4">History</h2>
        <div id="history" class="space-y-2 max-h-96 overflow-y-auto"></div>
        <button onclick="loadHistory()" class="mt-4 text-sm text-blue-400 underline">Refresh</button>
      </div>
    </div>

    <div id="results" class="hidden">
      <h2 class="text-2xl font-bold mb-6">10 Use Cases for <span id="target-name"></span></h2>
      <div id="use-cases" class="grid md:grid-cols-2 gap-4"></div>
    </div>
  </div>

  <script>
    const API = "https://pulseai-backend-1-qq5t.onrender.com/"; // YOUR BACKEND

    async function generate() {
      const data = {
        job_title: document.getElementById("job").value || "Sales Director",
        company: document.getElementById("company").value || "AccelAI",
        product: document.getElementById("product").value || "AI Optimizer",
        target_company: document.getElementById("target").value || "Xero"
      };

      document.getElementById("results").classList.add("hidden");
      const btn = event.target;
      btn.innerHTML = "Generating...";
      btn.disabled = true;

      try {
        const res = await fetch(`${API}/generate`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
        const result = await res.json();

        document.getElementById("target-name").textContent = data.target_company;
        const container = document.getElementById("use-cases");
        container.innerHTML = "";
        result.use_cases.forEach((uc, i) => {
          const div = document.createElement("div");
          div.className = "use-case card p-4 rounded-xl";
          div.innerHTML = `
            <h3 class="font-bold text-lg mb-2">${i+1}. ${uc.title || "AI Optimization"}</h3>
            <p class="text-sm mb-3">${uc.context || "Strong AI signals detected → Source: Public filings"}</p>
            <p class="text-blue-400 text-sm">${uc.solution || "Your product saves 30% on inference costs"}</p>
            <button onclick='email("${uc.context}", "${data.target_company}")' class="mt-3 text-xs bg-blue-600 px-3 py-1 rounded-full">Send to Outlook</button>
          `;
          container.appendChild(div);
        });

        document.getElementById("results").classList.remove("hidden");
        loadHistory();
      } catch (e) {
        alert("Backend sleeping? Wait 20s or ping: " + API);
      }

      btn.innerHTML = "GO";
      btn.disabled = false;
    }

    async function loadHistory() {
      try {
        const res = await fetch(`${API}/history`);
        const history = await res.json();
        const container = document.getElementById("history");
        container.innerHTML = "";
        history.slice(0, 5).forEach(h => {
          const div = document.createElement("div");
          div.className = "text-xs p-2 bg-white/5 rounded";
          div.textContent = `${h.target_company} • ${h.date || new Date().toLocaleDateString()}`;
          div.onclick = () => {
            document.getElementById("target").value = h.target_company;
            document.getElementById("results").classList.add("hidden");
          };
          container.appendChild(div);
        });
      } catch (e) {}
    }

    function email(context, target) {
      const body = encodeURIComponent(`${context}\n\nLet's explore how we can help. 15-min call?\n\nBest,\n[Your Name]`);
      window.open(`https://outlook.office.com/mail/deeplink/compose?to=&subject=PULSEAI%20Insight%20for%20${target}&body=${body}`);
    }

    // Auto-load history
    loadHistory();
  </script>
</body>
</html>
